{"name":"Nagios Plugin LCG SAM","tagline":"Service Availability Monitoring for LCG sites","body":"Nagios Plugin for LCG SAM\r\n=========================\r\n\r\n### Overview\r\nThis is a Nagios plugin to check Service Availability Monitoring required test meant to be used by the sites forming [ALICE](http://home.web.cern.ch/about/experiments/alice), [ATLAS](http://home.web.cern.ch/about/experiments/atlas), [CMS](http://home.web.cern.ch/about/experiments/cms) and [LHCb](http://home.web.cern.ch/about/experiments/lhcb) experiments.\r\n\r\nThis check uses the dashboard data for these experiments based on the Nagios Site Usability tests (SUM).\r\n\r\n### Authors\r\nMindcrafted by Pablo Saiz ([CERN](http://www.cern.ch)) and Pepe Flix ([PIC](http://www.pic.es)). Handcrafted by Jordi Casals ([PIC](http://www.pic.es)).\r\n\r\nContact: jcasals (at) pic (dot) es\r\n\r\n### Changelog\r\nWed Dec 3 2014 1.1.0\r\n- Changed URL to use SAM3\r\n\r\nMon Mar 18 2014 1.0.1\r\n- Added server error check\r\n\r\nFri Mar 14 2014 1.0.0\r\n- First Release!\r\n\r\n### Requirements\r\nIt consists on a Bash script and the only requirement is to have [JQ](http://stedolan.github.io/jq/) package installed, a simple and flexible JSON processor for bash.\r\n\r\n### Installation\r\nYou just have to install it via RPM and, if you don't have JQ on your server, it will install it as requirement.\r\n```\r\n$ yum install nagios-plugins-lcgsam\r\n```\r\n\r\n### Usage\r\n```\r\n$ /usr/lib64/nagios/plugins/check_lcgsam -v <vo> -p <profile> -s <site> [-f <flavour1[,flavour2,...]>]\r\n```\r\nAs you can see it has four parameters. \r\n- vo (-v), profile (-p) and site (-s) are mandatory. \r\n- flavour (-f) is optional. You can specify multiple flavours, one, or none. \r\n\r\n\\* If you specify no flavour, this will return all flavours for this vo, profile and site combination.\r\n\r\nYou can see an example of how it works by running it on your command line:\r\n```\r\n$ /usr/lib64/nagios/plugins/check_lcgsam -v atlas -p ATLAS_CRITICAL -s pic -f CREAM-CE,SRMv2\r\nCREAM-CE: OK // SRMv2: OK\r\n\r\nHOSTS\r\n======\r\nCREAM-CE\r\nce07.pic.es: OK\r\nce08.pic.es: OK\r\nce09.pic.es: OK\r\nce10.pic.es: OK\r\nce11.pic.es: OK\r\nSRMv2\r\nsrmatlas.pic.es: OK\r\n\r\nAll hosts in flavour/s CREAM-CE,SRMv2 OK!\r\n```\r\n\r\n### Setup for Nagios\r\nTo add the plugin to your Nagios System you just have to create a command as you usually do with other plugins. A sample of command line input on the NagiosQL setup can be:\r\n```\r\n$USER1$/check_lcgsam -v $ARG1$ -p $ARG2$ -s $ARG3$ -f $ARG4$\r\n```\r\nOr if you prefer, you can create this command on your *commands.cfg* file:\r\n```\r\ndefine command {\r\n    command_name    check_lcgsam\r\n    command_line    $USER1$/check_lcgsam -v $ARG1$ -p $ARG2$ -s $ARG3$ -f $ARG4$\r\n}\r\n```\r\n\r\n#### Optional Setup for Nagios\r\nWe tried to add a little more information to the Nagios output, so we wanted to add links that points out to the errors, in case it was an error. We found there are some characters not admitted, and that the HTML is disabled in the output. \r\n\r\nTo change this you have to modify two files.\r\n\r\n***/usr/local/nagios/etc/cgi.cfg*** *or your equivalent cgi.cfg*\r\n```\r\n# escape_html_tags=1\r\nescape_html_tags=0\r\n```\r\n***/usr/local/nagios/etc/nagios.cfg*** *or your equivalent nagios.cfg or icinga.cfg*\r\n```\r\n# illegal_object_name_chars=`~!$%^&*|'\"<>?,()=\r\nillegal_object_name_chars=`~!$%^&*|'\"?,()=\r\n```\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}